<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Job Application Test Page</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
    <div class="container mx-auto px-4 py-8 max-w-2xl">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-800 mb-2">Software Engineer</h1>
            <p class="text-lg text-gray-600">Test Company Inc.</p>
            <p class="text-sm text-gray-500">San Francisco, CA • Full-time</p>
        </div>

        <!-- Job Application Form -->
        <div class="bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-xl font-semibold text-gray-800 mb-6">Application Form</h2>
            
            <form id="applicationForm" class="space-y-6">
                <!-- Personal Information -->
                <div class="space-y-4">
                    <h3 class="text-lg font-medium text-gray-700">Personal Information</h3>
                    
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
                            <input type="text" name="fullName" id="fullName" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Enter your full name">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                            <input type="email" name="email" id="email" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="your.email@example.com">
                        </div>
                    </div>
                    
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Phone</label>
                            <input type="tel" name="phone" id="phone" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="(555) 123-4567">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Location</label>
                            <input type="text" name="location" id="location" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="City, State">
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">LinkedIn Profile</label>
                        <input type="url" name="linkedin" id="linkedin" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="https://linkedin.com/in/yourprofile">
                    </div>
                </div>

                <!-- Professional Information -->
                <div class="space-y-4">
                    <h3 class="text-lg font-medium text-gray-700">Professional Information</h3>
                    
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Current Company</label>
                            <input type="text" name="currentCompany" id="currentCompany" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Your current company">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Current Title</label>
                            <input type="text" name="currentTitle" id="currentTitle" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Your current job title">
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Years of Experience</label>
                        <select name="experienceYears" id="experienceYears" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="">Select experience level</option>
                            <option value="0-1">0-1 years</option>
                            <option value="1-3">1-3 years</option>
                            <option value="3-5">3-5 years</option>
                            <option value="5-10">5-10 years</option>
                            <option value="10+">10+ years</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Skills</label>
                        <textarea name="skills" id="skills" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="JavaScript, React, Node.js, Python..."></textarea>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Education</label>
                        <textarea name="education" id="education" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Bachelor's in Computer Science from..."></textarea>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Professional Summary</label>
                        <textarea name="summary" id="summary" rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Brief professional summary..."></textarea>
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="pt-4">
                    <button type="submit" class="w-full bg-blue-600 text-white py-3 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 font-medium">
                        Submit Application
                    </button>
                </div>
            </form>
        </div>

        <!-- Test Controls -->
        <div class="mt-8 bg-white rounded-lg shadow-lg p-6">
            <h3 class="text-lg font-medium text-gray-700 mb-4">Test Controls</h3>
            
            <div class="space-y-4">
                <div class="flex flex-wrap gap-2">
                    <button id="testAutoFill" class="bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500">
                        Test Auto-Fill
                    </button>
                    
                    <button id="triggerExtension" class="bg-purple-600 text-white px-4 py-2 rounded-md hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500">
                        Trigger Extension
                    </button>
                    
                    <button id="clearForm" class="bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500">
                        Clear Form
                    </button>
                    
                    <button id="showFormInfo" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        Show Form Info
                    </button>
                </div>
                
                <div class="flex flex-wrap gap-2">
                    <button id="checkExtension" class="bg-orange-600 text-white px-4 py-2 rounded-md hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-orange-500">
                        Check Extension Status
                    </button>
                    
                    <button id="testStorage" class="bg-teal-600 text-white px-4 py-2 rounded-md hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-teal-500">
                        Test Storage
                    </button>
                </div>
            </div>
            
            <div id="formInfo" class="mt-4 p-4 bg-gray-100 rounded-md hidden">
                <pre class="text-sm text-gray-700"></pre>
            </div>
            
            <div id="debugInfo" class="mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-md">
                <h4 class="font-medium text-yellow-800 mb-2">Debug Information</h4>
                <div id="debugContent" class="text-sm text-yellow-700">
                    <p>Extension status: <span id="extensionStatus">Checking...</span></p>
                    <p>Profile data: <span id="profileStatus">Checking...</span></p>
                    <p>Settings: <span id="settingsStatus">Checking...</span></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Form submission handler
        document.getElementById('applicationForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData);
            console.log('Form submitted:', data);
            alert('Application submitted! (This is a test page)');
        });

        // Test auto-fill
        document.getElementById('testAutoFill').addEventListener('click', () => {
            // Simulate extension auto-fill
            const testData = {
                fullName: 'John Doe',
                email: 'john.doe@example.com',
                phone: '(555) 123-4567',
                location: 'San Francisco, CA',
                linkedin: 'https://linkedin.com/in/johndoe',
                currentCompany: 'Tech Corp',
                currentTitle: 'Senior Developer',
                experienceYears: '3-5',
                skills: 'JavaScript, React, Node.js, Python, AWS',
                education: 'Bachelor\'s in Computer Science from Stanford University',
                summary: 'Experienced software engineer with 4+ years building scalable web applications.'
            };

            Object.keys(testData).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    element.value = testData[key];
                    element.dispatchEvent(new Event('input', { bubbles: true }));
                    element.dispatchEvent(new Event('change', { bubbles: true }));
                }
            });

            console.log('Test data filled');
        });

        // Trigger extension auto-fill
        document.getElementById('triggerExtension').addEventListener('click', () => {
            console.log('🔵 [TEST PAGE] Triggering extension auto-fill...');
            // Send a custom event that the content script will listen for
            const event = new CustomEvent('triggerExtensionAutoFill', {
                detail: { action: 'autoFill' }
            });
            console.log('🔵 [TEST PAGE] Dispatching event:', event);
            document.dispatchEvent(event);
            console.log('🔵 [TEST PAGE] Event dispatched successfully');
        });

        // Clear form
        document.getElementById('clearForm').addEventListener('click', () => {
            document.getElementById('applicationForm').reset();
            console.log('Form cleared');
        });

        // Show form info
        document.getElementById('showFormInfo').addEventListener('click', () => {
            const form = document.getElementById('applicationForm');
            const inputs = form.querySelectorAll('input, textarea, select');
            const formInfo = Array.from(inputs).map(input => ({
                name: input.name,
                id: input.id,
                type: input.type,
                placeholder: input.placeholder,
                value: input.value
            }));

            const infoDiv = document.getElementById('formInfo');
            const pre = infoDiv.querySelector('pre');
            pre.textContent = JSON.stringify(formInfo, null, 2);
            infoDiv.classList.remove('hidden');
        });

        // Check extension status
        document.getElementById('checkExtension').addEventListener('click', () => {
            console.log('🔵 [TEST PAGE] Checking extension status...');
            // Send a custom event that the content script will listen for
            const event = new CustomEvent('checkExtensionStatus', {
                detail: { action: 'getSettings' }
            });
            console.log('🔵 [TEST PAGE] Dispatching event:', event);
            document.dispatchEvent(event);
            console.log('🔵 [TEST PAGE] Event dispatched successfully');
        });

        // Test storage
        document.getElementById('testStorage').addEventListener('click', () => {
            console.log('🔵 [TEST PAGE] Testing storage...');
            // Send a custom event that the content script will listen for
            const event = new CustomEvent('testStorage', {
                detail: { action: 'getProfile' }
            });
            console.log('🔵 [TEST PAGE] Dispatching event:', event);
            document.dispatchEvent(event);
            console.log('🔵 [TEST PAGE] Event dispatched successfully');
        });

        // Auto-check extension status on page load
        window.addEventListener('load', () => {
            console.log('🔵 [TEST PAGE] Page loaded, setting up auto-check...');
            setTimeout(() => {
                console.log('🔵 [TEST PAGE] Running auto-checks...');
                document.getElementById('checkExtension').click();
                document.getElementById('testStorage').click();
            }, 1000);
        });

        // Listen for responses from the extension
        document.addEventListener('extensionResponse', (event) => {
            console.log('🟢 [TEST PAGE] Extension response received:', event.detail);
            
            const { success, message, action, data, error } = event.detail;
            
            if (success) {
                console.log(`🟢 [TEST PAGE] ✅ ${message}`);
                if (action === 'autoFill') {
                    alert('Extension auto-fill triggered successfully!');
                }
            } else {
                console.error(`🟢 [TEST PAGE] ❌ ${message}: ${error}`);
                if (action === 'autoFill') {
                    alert(`Extension error: ${error}`);
                }
            }
        });

        // Debug: Check if content script is loaded
        console.log('🔵 [TEST PAGE] Test page script loaded');
        console.log('🔵 [TEST PAGE] Checking if content script is available...');
        
        // Try to detect if content script is loaded by checking for a global variable
        setTimeout(() => {
            console.log('🔵 [TEST PAGE] Content script detection check...');
            if (window.contentScriptLoaded) {
                console.log('🟢 [TEST PAGE] ✅ Content script is loaded!');
            } else {
                console.log('🔴 [TEST PAGE] ❌ Content script is NOT loaded!');
                console.log('🔴 [TEST PAGE] This means the extension is not working properly.');
            }
        }, 500);
    </script>
</body>
</html> 